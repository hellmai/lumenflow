id: WU-2277
title: Fix require-wu path scope to repo
lane: 'Framework: CLI Enforcement'
type: feature
status: ready
priority: P2
created: 2026-02-28
code_paths:
  - packages/@lumenflow/cli/src/hooks/**
tests:
  manual:
    - Verify Write/Edit to /tmp and ~/.claude do not require claimed WU while repo writes still do
  unit:
    - packages/@lumenflow/cli/src/__tests__/hooks/enforcement.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2277.done
dependencies: []
spec_refs:
  - lumenflow://plans/WU-2277-plan.md
risks: []
notes: ''
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: require-wu hook currently blocks Write/Edit outside repo because it only checks claimed WU state. Add path-aware repo boundary check so enforcement applies only to repo writes.
acceptance:
  - Outside-repo writes (including /tmp and home-relative paths) are allowed without WU; in-repo writes still require claimed WU; generated hook script and runtime checks stay consistent.
