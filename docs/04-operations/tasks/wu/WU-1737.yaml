id: WU-1737
title: CLI surface — remaining commands (gates, orchestration, inspect, replay)
lane: 'Framework: CLI Orchestration'
type: feature
status: ready
priority: P2
created: 2026-02-16
code_paths:
  - packages/@lumenflow/surfaces/cli/
tests:
  manual:
    - pnpm gates runs through new PolicyEngine path
  unit:
    - packages/@lumenflow/surfaces/cli/__tests__/gates.test.ts
    - packages/@lumenflow/surfaces/cli/__tests__/inspect.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1737.done
dependencies: []
initiative: INIT-029
phase: 4
blocked_by:
  - WU-1736
labels:
  - surfaces
  - phase-4
  - cli
spec_refs:
  - .claude/plans/golden-prancing-cookie.md
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: INIT-029 Phase 4 — Surfaces + Daemon. Depends on WU-1736 (CLI tracer bullet). Problem: After the tracer bullet proves KernelRuntime works for lifecycle commands, all remaining CLI commands need to be rewritten as thin KernelRuntime wrappers. Solution: Rewrite gates, orchestration, inspect, replay, and remaining CLI commands to call KernelRuntime instead of importing core directly. lumenflow inspect shows full execution trace with receipts and policy decisions. lumenflow replay re-executes from stored CAS inputs. Plan: .claude/plans/golden-prancing-cookie.md'
acceptance:
  - Gates command runs gate policies through PolicyEngine (not hardcoded gate runner)
  - Orchestration commands (monitor, init-status) work through KernelRuntime
  - 'lumenflow inspect shows: task state, run history, tool receipts, policy decisions, evidence'
  - lumenflow replay can re-execute a run from stored CAS inputs
  - All CLI commands have zero direct imports from @lumenflow/core
  - CLI surface package depends only on @lumenflow/kernel, not @lumenflow/core
